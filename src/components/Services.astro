---
import { Home as HomeIcon, Hammer, Wrench, Paintbrush } from 'lucide-astro';
import type { Translations } from '../types';

interface Props {
  t: Translations;
}

const { t } = Astro.props;

const services = [
  { data: t.services.residential, Icon: HomeIcon, accent: 'bg-cyan-dark' },
  { data: t.services.construction, Icon: Hammer, accent: 'bg-yellow-custom' },
  { data: t.services.handyman, Icon: Wrench, accent: 'bg-cyan-light' },
  { data: t.services.interior, Icon: Paintbrush, accent: 'bg-cyan-dark' },
];
---

<section id="services" class="py-20 bg-[#034942]">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-16">
      <h2 class="text-4xl font-bold text-white mb-4">{t.services.title}</h2>
      <div class="w-24 h-1 bg-yellow-custom mx-auto mb-6"></div>
      <p class="text-lg text-white/90 max-w-3xl mx-auto">
        <span class="text-yellow-custom font-semibold">{t.tagline}</span>
      </p>
    </div>

    <!-- Services Grid -->
    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
      {services.map((service, i) => (
        <div
          data-service-card={i}
          class="service-card relative overflow-hidden cursor-pointer rounded-2xl p-6 bg-gradient-to-br from-[#045a52] to-[#034a43] border-2 border-yellow-custom/30 hover:border-yellow-custom transition-all duration-300 shadow-lg"
        >
          <!-- Overlay para cards inactivas -->
          <div class="card-overlay absolute inset-0 z-10 flex flex-col items-center justify-center bg-[#034a43]/95 backdrop-blur-sm transition-opacity duration-300">
            <service.Icon class="w-16 h-16 text-yellow-custom mb-3" />
            <span class="uppercase tracking-widest text-xs text-yellow-custom font-semibold text-center px-2">{service.data.title}</span>
          </div>

          <!-- Card Header -->
          <div class="mb-4">
            <div class={`w-14 h-14 rounded-xl ${service.accent} flex items-center justify-center mb-4 shadow-lg`}>
              <service.Icon class="w-7 h-7 text-white" />
            </div>
            <h3 class="text-xl font-bold text-white">
              {service.data.title}
            </h3>
          </div>

          <!-- Expanded Content -->
          <div class="card-content opacity-0 max-h-0 overflow-hidden transition-all duration-500">
            <ul class="space-y-2 text-white/90 text-sm mb-4">
              {service.data.items.map((item) => (
                <li class="flex items-start gap-2">
                  <span class="text-yellow-custom mt-1">â€¢</span>
                  <span>{item}</span>
                </li>
              ))}
            </ul>

            <button
              data-scroll-to="contact"
              class="mt-4 w-full px-6 py-3 bg-yellow-custom text-cyan-dark rounded-xl font-bold hover:bg-white hover:text-cyan-dark transition-all duration-300 shadow-lg"
            >
              {t.hero.cta}
            </button>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .service-card.active {
    @apply border-yellow-custom bg-gradient-to-br from-[#045a52] to-[#023832] shadow-2xl;
  }

  .service-card.active .card-overlay {
    @apply opacity-0 pointer-events-none;
  }

  .service-card.active .card-content {
    @apply opacity-100 max-h-[600px];
  }

  .service-card:not(.active):hover {
    @apply shadow-xl;
  }
</style>

<script>
  // Manejo interactivo de las tarjetas de servicio
  const cards = document.querySelectorAll('[data-service-card]');
  
  // Activar la primera card por defecto
  if (cards.length > 0) {
    cards[0].classList.add('active');
  }

  cards.forEach((card, index) => {
    card.addEventListener('click', () => {
      // Remover active de todas las cards
      cards.forEach(c => c.classList.remove('active'));
      // Agregar active a la card clickeada
      card.classList.add('active');
    });
  });

  // Smooth scroll para los botones
  document.querySelectorAll('[data-scroll-to]').forEach(button => {
    button.addEventListener('click', (e) => {
      e.stopPropagation();
      const target = (e.currentTarget as HTMLElement).getAttribute('data-scroll-to');
      if (target) {
        const element = document.getElementById(target);
        element?.scrollIntoView({ behavior: 'smooth' });
      }
    });
  });
</script>
